----------------------------------------------------------------------------------------------------
------------------------------------ MegaLinter, by OX Security ------------------------------------
----------------------------------------------------------------------------------------------------
 - Image Creation Date: 2024-02-11T21:47:21Z
 - Image Revision: 190cd0dad6dc52b2de5b810e3b290c3d6bdcc0f2
 - Image Version: v7.9.0
----------------------------------------------------------------------------------------------------
The MegaLinter documentation can be found at:
 - https://megalinter.io/7.9.0
----------------------------------------------------------------------------------------------------
::group::MegaLinter initialization (expand for details)
MegaLinter will analyze workspace [/github/workspace]
GITHUB_REPOSITORY: homeall/caddy-reverse-proxy-cloudflare
GITHUB_REF: refs/pull/24/merge
GITHUB_RUN_ID: 8185374693


[Activation] ANSIBLE_ANSIBLE_LINT has been set inactive, as subdirectory has not been found: ansible (set value "any" to always activate)
[Activation] EDITORCONFIG_EDITORCONFIG_CHECKER has been set inactive, as none of these files has been found: ['.editorconfig']
[Activation] JAVASCRIPT_ES has been set inactive, as none of these files has been found: ['.eslintrc.json', '.eslintrc.yml', '.eslintrc.yaml', '.eslintrc.js', '.eslintrc.cjs', 'package.json:eslintConfig']
[Activation] JSON_NPM_PACKAGE_JSON_LINT has been set inactive, as none of these files has been found: ['package.json']
[Activation] JSX_ESLINT has been set inactive, as none of these files has been found: ['.eslintrc.json', '.eslintrc.yml', '.eslintrc.yaml', '.eslintrc.js', '.eslintrc.cjs', 'package.json:eslintConfig']
[Activation] KUBERNETES_KUBECONFORM has been set inactive, as subdirectory has not been found: kubernetes (set value "any" to always activate)
[Activation] KUBERNETES_HELM has been set inactive, as none of these files has been found: ['Chart.yml', 'Chart.yaml']
[Activation] KUBERNETES_KUBESCAPE has been set inactive, as none of these files has been found: ['Chart.yml', 'Chart.yaml']
[SemgrepLinter] Deactivated because no ruleset has been defined
[Activation] SALESFORCE_SFDX_SCANNER_APEX has been set inactive, as subdirectory has not been found: force-app (set value "any" to always activate)
[Activation] SALESFORCE_SFDX_SCANNER_AURA has been set inactive, as subdirectory has not been found: force-app (set value "any" to always activate)
[Activation] SALESFORCE_SFDX_SCANNER_LWC has been set inactive, as subdirectory has not been found: force-app (set value "any" to always activate)
[Activation] SALESFORCE_LIGHTNING_FLOW_SCANNER has been set inactive, as subdirectory has not been found: force-app (set value "any" to always activate)
[Activation] SPELL_PROSELINT has been set inactive, as none of these files has been found: ['.proselintrc', 'proselint/config.json']
[Activation] SPELL_VALE has been set inactive, as none of these files has been found: ['.vale.ini']
[Activation] SQL_SQLFLUFF has been set inactive, as none of these files has been found: ['.sqlfluff']
[Activation] SWIFT_SWIFTLINT has been set inactive, as none of these files has been found: ['.swiftlint.yml']
[Activation] TSX_ESLINT has been set inactive, as none of these files has been found: ['.eslintrc.json', '.eslintrc.yml', '.eslintrc.yaml', '.eslintrc.js', '.eslintrc.cjs', 'package.json:eslintConfig']
[Activation] TYPESCRIPT_ES has been set inactive, as none of these files has been found: ['.eslintrc.json', '.eslintrc.yml', '.eslintrc.yaml', '.eslintrc.js', '.eslintrc.cjs', 'package.json:eslintConfig']
CLOJURE_CLJSTYLE has been temporary disabled in MegaLinter, please use a previous MegaLinter version or wait for the next one !
MARKDOWN_REMARK_LINT has been temporary disabled in MegaLinter, please use a previous MegaLinter version or wait for the next one !
Skipped linters: ANSIBLE_ANSIBLE_LINT, CLOJURE_CLJSTYLE, EDITORCONFIG_EDITORCONFIG_CHECKER, JAVASCRIPT_ES, JAVASCRIPT_PRETTIER, JSON_NPM_PACKAGE_JSON_LINT, JSX_ESLINT, KUBERNETES_HELM, KUBERNETES_KUBECONFORM, KUBERNETES_KUBESCAPE, MARKDOWN_REMARK_LINT, REPOSITORY_SEMGREP, SALESFORCE_LIGHTNING_FLOW_SCANNER, SALESFORCE_SFDX_SCANNER_APEX, SALESFORCE_SFDX_SCANNER_AURA, SALESFORCE_SFDX_SCANNER_LWC, SPELL_PROSELINT, SPELL_VALE, SQL_SQLFLUFF, SWIFT_SWIFTLINT, TSX_ESLINT, TYPESCRIPT_ES, TYPESCRIPT_PRETTIER
To receive reports as email, please set variable EMAIL_REPORTER_EMAIL
::endgroup::
::group::MegaLinter now collects the files to analyse (expand for details)
Listing updated files in [/github/workspace] using git diff.
Modified files:
CONTRIBUTING.md
Dockerfile
SECURITY.md
docker-compose.yml
- File extensions: , .R, .RMD, .Rmd, .bash, .bicep, .c, .c++, .cc, .cdxml, .clj, .cljc, .cljs, .coffee, .cpp, .cs, .csproj, .css, .cu, .cuh, .cxx, .dart, .dash, .edn, .env, .feature, .go, .gradle, .graphql, .groovy, .gvy, .h, .h++, .hcl, .hh, .hpp, .htm, .html, .hxx, .java, .js, .json, .json5, .jsonc, .ksh, .kt, .kts, .lua, .markdown, .md, .mdx, .nf, .p6, .php, .pl, .pl6, .pm, .pm6, .pp, .proto, .ps1, .ps1xml, .psd1, .psm1, .psrc, .pssc, .py, .r, .raku, .rakumod, .rakutest, .rb, .rs, .rst, .saas, .scala, .scss, .sh, .smk, .sql, .t, .tex, .tf, .ts, .txt, .vb, .xml, .yaml, .yml
- File names (regex): Containerfile, Dockerfile, Jenkinsfile, Makefile, Snakefile
- Excluding .gitignored files [0]: 
Kept [4] files on [4] found files

+----MATCHING LINTERS-------------------+------------------------------------------------------------------------+----------------+------------+
| Descriptor | Linter                   | Criteria                                                               | Matching files | Format/Fix |
+------------+--------------------------+------------------------------------------------------------------------+----------------+------------+
| COPYPASTE  | jscpd                    |                                                                        | project        | no         |
| DOCKERFILE | hadolint                 | Containerfile|Dockerfile                                               | 1              | no         |
| MARKDOWN   | markdownlint             | .md                                                                    | 2              | yes        |
| MARKDOWN   | markdown-link-check      | .md                                                                    | 2              | no         |
| MARKDOWN   | markdown-table-formatter | .md                                                                    | 2              | yes        |
| REPOSITORY | checkov                  |                                                                        | project        | no         |
| REPOSITORY | devskim                  |                                                                        | project        | no         |
| REPOSITORY | dustilock                |                                                                        | project        | no         |
| REPOSITORY | git_diff                 |                                                                        | project        | no         |
| REPOSITORY | gitleaks                 |                                                                        | project        | no         |
| REPOSITORY | grype                    |                                                                        | project        | no         |
| REPOSITORY | kics                     |                                                                        | project        | no         |
| REPOSITORY | secretlint               |                                                                        | project        | no         |
| REPOSITORY | syft                     |                                                                        | project        | no         |
| REPOSITORY | trivy                    |                                                                        | project        | no         |
| REPOSITORY | trivy-sbom               |                                                                        | project        | no         |
| REPOSITORY | trufflehog               |                                                                        | project        | no         |
| SPELL      | cspell                   |                                                                        | 4              | no         |
| SPELL      | lychee                   | .md|.mdx|.markdown|.html|.htm|.rst|.txt|.json|.jsonc|.json5|.yaml|.yml | 3              | no         |
| YAML       | prettier                 | .yml|.yaml                                                             | 1              | yes        |
| YAML       | yamllint                 | .yml|.yaml                                                             | 1              | no         |
| YAML       | v8r                      | .yml|.yaml                                                             | 1              | no         |
+------------+--------------------------+------------------------------------------------------------------------+----------------+------------+
::endgroup::
Processing linters on [4] parallel cores…
::group::[32m✅ Linted [YAML] files with [prettier] successfully - (0.47s)[0m (expand for details)
- Using [prettier v3.2.5] https://megalinter.io/7.9.0/descriptors/yaml_prettier
- MegaLinter key: [YAML_PRETTIER]
- Rules config: identified by [prettier]
- Number of files analyzed: [1]
::endgroup::
::group::[33m✅ Linted [MARKDOWN] files with [markdownlint]: Found 1 non blocking error(s) - (0.67s)[0m (expand for details)
- Using [markdownlint v0.39.0] https://megalinter.io/7.9.0/descriptors/markdown_markdownlint
- MegaLinter key: [MARKDOWN_MARKDOWNLINT]
- Rules config: [.markdownlint.json]
- Number of files analyzed: [2]
--Error detail:
SECURITY.md:3 MD025/single-title/single-h1 Multiple top-level headings in the same document [Context: "# Table of Contents"]

::endgroup::
::group::[32m✅ Linted [MARKDOWN] files with [markdown-table-formatter] successfully - (0.27s)[0m (expand for details)
- Using [markdown-table-formatter v1.5.0] https://megalinter.io/7.9.0/descriptors/markdown_markdown_table_formatter
- MegaLinter key: [MARKDOWN_MARKDOWN_TABLE_FORMATTER]
- Rules config: identified by [markdown-table-formatter]
- Number of files analyzed: [2]
::endgroup::
::group::[32m✅ Linted [COPYPASTE] files with [jscpd] successfully - (0.83s)[0m (expand for details)
- Using [jscpd v3.5.10] https://megalinter.io/7.9.0/descriptors/copypaste_jscpd
- MegaLinter key: [COPYPASTE_JSCPD]
- Rules config: [.jscpd.json]
::endgroup::
::group::[32m✅ Linted [MARKDOWN] files with [markdown-link-check] successfully - (1.29s)[0m (expand for details)
- Using [markdown-link-check v3.11.2] https://megalinter.io/7.9.0/descriptors/markdown_markdown_link_check
- MegaLinter key: [MARKDOWN_MARKDOWN_LINK_CHECK]
- Rules config: [.markdown-link-check.json]
- Number of files analyzed: [2]
::endgroup::
::group::[32m✅ Linted [REPOSITORY] files with [devskim] successfully - (1.48s)[0m (expand for details)
- Using [devskim v1.0.28] https://megalinter.io/7.9.0/descriptors/repository_devskim
- MegaLinter key: [REPOSITORY_DEVSKIM]
- Rules config: [.devskim.json]
::endgroup::
::group::[32m✅ Linted [REPOSITORY] files with [secretlint] successfully - (1.05s)[0m (expand for details)
- Using [secretlint v8.1.1] https://megalinter.io/7.9.0/descriptors/repository_secretlint
- MegaLinter key: [REPOSITORY_SECRETLINT]
- Rules config: [.secretlintrc.json]
- Ignore file: [.secretlintignore]
::endgroup::
::group::[32m✅ Linted [YAML] files with [v8r] successfully - (2.34s)[0m (expand for details)
- Using [v8r v3.0.0] https://megalinter.io/7.9.0/descriptors/yaml_v8r
- MegaLinter key: [YAML_V8R]
- Rules config: identified by [v8r]
- Number of files analyzed: [1]
::endgroup::
::group::[33m✅ Linted [SPELL] files with [cspell]: Found 17 non blocking error(s) - (3.19s)[0m (expand for details)
- Using [cspell v8.3.2] https://megalinter.io/7.9.0/descriptors/spell_cspell
- MegaLinter key: [SPELL_CSPELL]
- Rules config: identified by [cspell]
- Number of files analyzed: [5]
--Error detail:
1/5 ./CONTRIBUTING.md 516.22ms
2/5 ./docker-compose.yml 281.72ms X
./docker-compose.yml:6:12      - Unknown word (homeall)    -- image: homeall/caddy-reverse-proxy
	 Suggestions: [homely, howell, holdall, Howell, hemal]
./docker-compose.yml:20:21     - Unknown word (whoiam)     -- container_name: whoiam
	 Suggestions: [wham, whim, whoa, whom, whoami]
./docker-compose.yml:21:12     - Unknown word (jwilder)    -- image: jwilder/whoami:latest
	 Suggestions: [wilder, Wilder, jailer, jilter, joinder]
3/5 ./Dockerfile 354.18ms X
./Dockerfile:4:58      - Unknown word (gobuild)    -- {ALPINE_VERSION} as gobuild
	 Suggestions: [gould, guild, Gould, build, ebuild]
./Dockerfile:8:28      - Unknown word (caddyserver) -- WORKDIR /go/src/github.com/caddyserver/xcaddy/cmd/xcaddy
	 Suggestions: []
./Dockerfile:8:40      - Unknown word (xcaddy)      -- github.com/caddyserver/xcaddy/cmd/xcaddy
	 Suggestions: [caddy, xcad, XCAD, baddy, cadgy]
./Dockerfile:8:51      - Unknown word (xcaddy)      -- caddyserver/xcaddy/cmd/xcaddy
	 Suggestions: [caddy, xcad, XCAD, baddy, cadgy]
./Dockerfile:11:24     - Unknown word (caddyserver) -- go install github.com/caddyserver/xcaddy/cmd/xcaddy@latest
	 Suggestions: []
./Dockerfile:11:36     - Unknown word (xcaddy)      -- github.com/caddyserver/xcaddy/cmd/xcaddy@latest
	 Suggestions: [caddy, xcad, XCAD, baddy, cadgy]
./Dockerfile:11:47     - Unknown word (xcaddy)      -- caddyserver/xcaddy/cmd/xcaddy@latest
	 Suggestions: [caddy, xcad, XCAD, baddy, cadgy]
./Dockerfile:13:6      - Unknown word (xcaddy)      -- RUN xcaddy build \
	 Suggestions: [caddy, xcad, XCAD, baddy, cadgy]
./Dockerfile:14:31     - Unknown word (caddyserver) -- output /go/src/github.com/caddyserver/xcaddy/cmd/caddy \
	 Suggestions: []
./Dockerfile:15:21     - Unknown word (lucaslorentz) -- --with github.com/lucaslorentz/caddy-docker-proxy/v
	 Suggestions: []
./Dockerfile:23:45     - Unknown word (tzdata)       -- ca-certificates curl tzdata; \
	 Suggestions: [tata, Tata, data, cdata, Data]
./Dockerfile:34:13     - Unknown word (gobuild)      -- COPY --from=gobuild /go/src/github.com/caddyserve
	 Suggestions: [gould, guild, Gould, build, ebuild]
./Dockerfile:34:40     - Unknown word (caddyserver)  -- gobuild /go/src/github.com/caddyserver/xcaddy/cmd/caddy /bin
	 Suggestions: []
4/5 ./fb4db528-f223-48c7-b3c6-69c75e600751-megalinter_file_names_cspell.txt 2.88ms
5/5 ./SECURITY.md 231.05ms X
./SECURITY.md:22:31     - Unknown word (if've)      -- encourage you to notify us if've found a security vulnerabilit
	 Suggestions: [i've, I've, five, if's, i'd've]
CSpell: Files checked: 5, Issues found: 17 in 3 files

::endgroup::
::group::[33m✅ Linted [REPOSITORY] files with [kics]: Found 1 non blocking error(s) - (5.53s)[0m (expand for details)
- Using [kics v1.7.12] https://megalinter.io/7.9.0/descriptors/repository_kics
- MegaLinter key: [REPOSITORY_KICS]
- Rules config: identified by [kics]
--Error detail:
[38;2;34;187;51m
                   .0MO.                                    
                   OMMMx                                    
                   ;NMX;                                    
                    ...           ...              ....     
WMMMd     cWMMM0.  KMMMO      ;xKWMMMMNOc.     ,xXMMMMMWXkc.
WMMMd   .0MMMN:    KMMMO    :XMMMMMMMMMMMWl   xMMMMMWMMMMMMl
WMMMd  lWMMMO.     KMMMO   xMMMMKc...'lXMk   ,MMMMx   .;dXx 
WMMMd.0MMMX;       KMMMO  cMMMMd        '    'MMMMNl'       
WMMMNWMMMMl        KMMMO  0MMMN               oMMMMMMMXkl.  
WMMMMMMMMMMo       KMMMO  0MMMX                .ckKWMMMMMM0.
WMMMMWokMMMMk      KMMMO  oMMMMc              .     .:OMMMM0
WMMMK.  dMMMM0.    KMMMO   KMMMMx'    ,kNc   :WOc.    .NMMMX
WMMMd    cWMMMX.   KMMMO    kMMMMMWXNMMMMMd .WMMMMWKO0NMMMMl
WMMMd     ,NMMMN,  KMMMO     'xNMMMMMMMNx,   .l0WMMMMMMMWk, 
xkkk:      ,kkkkx  okkkl        ;xKXKx;          ;dOKKkc    

[0m
Scanning with Keeping Infrastructure as Code Secure v1.7.12



Files scanned: 4
Parsed files: 4
Queries loaded: 74
Queries failed to execute: 0

------------------------------------

[38;2;237;213;126mCpus Not Limited[0m, Severity: [38;2;237;213;126mLOW[0m, Results: 2
[1mDescription:[0m CPU limits should be set because if the system has CPU time free, a container is guaranteed to be allocated as much CPU as it requests
[1mPlatform:[0m DockerCompose
[1mLearn more about this vulnerability:[0m https://docs.kics.io/latest/queries/dockercompose-queries/6b610c50-99fb-4ef0-a5f3-e312fd945bc3

	[38;2;237;213;126m[1]:[0m docker-compose.yml:[38;2;34;187;51m4[0m

		003: services:
[38;2;240;173;78m		004:   caddy:
[0m		005:     container_name: caddy


	[38;2;237;213;126m[2]:[0m docker-compose.yml:[38;2;34;187;51m19[0m

		018: 
[38;2;240;173;78m		019:   whoami0:
[0m		020:     container_name: whoiam


[38;2;237;213;126mContainer Capabilities Unrestricted[0m, Severity: [38;2;237;213;126mLOW[0m, Results: 2
[1mDescription:[0m Some capabilities are not needed in certain (or any) containers. Make sure that you only add capabilities that your container needs. Drop unnecessary capabilities as well.
[1mPlatform:[0m DockerCompose
[1mLearn more about this vulnerability:[0m https://docs.kics.io/latest/queries/dockercompose-queries/ce76b7d0-9e77-464d-b86f-c5c48e03e22d

	[38;2;237;213;126m[1]:[0m docker-compose.yml:[38;2;34;187;51m19[0m

		018: 
[38;2;240;173;78m		019:   whoami0:
[0m		020:     container_name: whoiam


	[38;2;237;213;126m[2]:[0m docker-compose.yml:[38;2;34;187;51m4[0m

		003: services:
[38;2;240;173;78m		004:   caddy:
[0m		005:     container_name: caddy


[38;2;255;114;19mUnpinned Package Version in Apk Add[0m, Severity: [38;2;255;114;19mMEDIUM[0m, Results: 2
[1mDescription:[0m Package version pinning reduces the range of versions that can be installed, reducing the chances of failure due to unanticipated changes
[1mPlatform:[0m Dockerfile
[1mLearn more about this vulnerability:[0m https://docs.kics.io/latest/queries/dockerfile-queries/d3499f6d-1651-41bb-a9a7-de925fea487b

	[38;2;255;114;19m[1]:[0m Dockerfile:[38;2;34;187;51m10[0m

		009: 
[38;2;240;173;78m		010: RUN apk add --no-cache git gcc build-base; 	go install github.com/caddyserver/xcaddy/cmd/xcaddy@latest
[0m		011: 


	[38;2;255;114;19m[2]:[0m Dockerfile:[38;2;34;187;51m23[0m

		022: 
[38;2;240;173;78m		023: RUN apk add --no-cache ca-certificates curl tzdata;              rm -rf /var/cache/apk/*;
[0m		024: 


[38;2;255;114;19mUnpinned Actions Full Length Commit SHA[0m, Severity: [38;2;255;114;19mMEDIUM[0m, Results: 8
[1mDescription:[0m Pinning an action to a full length commit SHA is currently the only way to use an action as an immutable release. Pinning to a particular SHA helps mitigate the risk of a bad actor adding a backdoor to the action's repository, as they would need to generate a SHA-1 collision for a valid Git object payload. When selecting a SHA, you should verify it is from the action's repository and not a repository fork.
[1mPlatform:[0m CICD
[1mLearn more about this vulnerability:[0m https://docs.kics.io/latest/queries/cicd-queries/555ab8f9-2001-455e-a077-f2d0f41e2fb9

	[38;2;255;114;19m[1]:[0m .github/workflows/main.yml:[38;2;34;187;51m45[0m

		044:       - name: Create github release
[38;2;240;173;78m		045:         uses: ncipollo/release-action@v1.13.0
[0m		046:         with:


	[38;2;255;114;19m[2]:[0m .github/workflows/main.yml:[38;2;34;187;51m21[0m

		020:       - name: Docker Login
[38;2;240;173;78m		021:         uses: docker/login-action@v2.2.0
[0m		022:         with:


	[38;2;255;114;19m[3]:[0m .github/workflows/mega-linter.yml:[38;2;34;187;51m45[0m

		044:           # More info at https://megalinter.io/flavors/
[38;2;240;173;78m		045:           uses: oxsecurity/megalinter@v7
[0m		046:           env:


	[38;2;255;114;19m[4]:[0m .github/workflows/mega-linter.yml:[38;2;34;187;51m86[0m

		085:           if: steps.ml.outputs.has_updated_sources == 1 && (env.APPLY_FIXES_EVENT == 'all' || env.APPLY_FIXES_EVENT == github.event_name) && env.APPLY_FIXES_MODE == 'commit' && github.ref != 'refs/heads/main' && (github.event_name == 'push' || github.even
[38;2;240;173;78m		086:           uses: stefanzweifel/git-auto-commit-action@v4
[0m		087:           with:


	[38;2;255;114;19m[5]:[0m .github/workflows/main.yml:[38;2;34;187;51m34[0m

		033:       - name: Build and push
[38;2;240;173;78m		034:         uses: docker/build-push-action@v5
[0m		035:         with:


	[38;2;255;114;19m[6]:[0m .github/workflows/main.yml:[38;2;34;187;51m27[0m

		026:       - name: Set up QEMU
[38;2;240;173;78m		027:         uses: docker/setup-qemu-action@v3.0.0
[0m		028: 


	[38;2;255;114;19m[7]:[0m .github/workflows/mega-linter.yml:[38;2;34;187;51m68[0m

		067:           if: steps.ml.outputs.has_updated_sources == 1 && (env.APPLY_FIXES_EVENT == 'all' || env.APPLY_FIXES_EVENT == github.event_name) && env.APPLY_FIXES_MODE == 'pull_request' && (github.event_name == 'push' || github.event.pull_request.head.repo.full
[38;2;240;173;78m		068:           uses: peter-evans/create-pull-request@v5
[0m		069:           with:


	[38;2;255;114;19m[8]:[0m .github/workflows/main.yml:[38;2;34;187;51m31[0m

		030:         id: buildx
[38;2;240;173;78m		031:         uses: docker/setup-buildx-action@v3.0.0
[0m		032: 


[38;2;255;114;19mSecurity Opt Not Set[0m, Severity: [38;2;255;114;19mMEDIUM[0m, Results: 2
[1mDescription:[0m Attribute 'security_opt' should be defined.
[1mPlatform:[0m DockerCompose
[1mLearn more about this vulnerability:[0m https://docs.kics.io/latest/queries/dockercompose-queries/610e266e-6c12-4bca-9925-1ed0cd29742b

	[38;2;255;114;19m[1]:[0m docker-compose.yml:[38;2;34;187;51m19[0m

		018: 
[38;2;240;173;78m		019:   whoami0:
[0m		020:     container_name: whoiam


	[38;2;255;114;19m[2]:[0m docker-compose.yml:[38;2;34;187;51m4[0m

		003: services:
[38;2;240;173;78m		004:   caddy:
[0m		005:     container_name: caddy


[38;2;255;114;19mPrivileged Ports Mapped In Container[0m, Severity: [38;2;255;114;19mMEDIUM[0m, Results: 1
[1mDescription:[0m Privileged ports (1 to 1023) should not be mapped. Also you should drop net_bind_service linux capability from the container unless you absolutely need to use priviledged ports.
[1mPlatform:[0m DockerCompose
[1mLearn more about this vulnerability:[0m https://docs.kics.io/latest/queries/dockercompose-queries/bc2908f3-f73c-40a9-8793-c1b7d5544f79

	[38;2;255;114;19m[1]:[0m docker-compose.yml:[38;2;34;187;51m13[0m

		012:       - "./caddy-data:/data" #### needs volume to back up certificates
[38;2;240;173;78m		013:     ports:
[0m		014:       - "80:80"


[38;2;255;114;19mNetworks Not Set[0m, Severity: [38;2;255;114;19mMEDIUM[0m, Results: 2
[1mDescription:[0m Setting networks in services ensures you are not using dockers default bridge (docker0), which shares traffic bewteen all containers.
[1mPlatform:[0m DockerCompose
[1mLearn more about this vulnerability:[0m https://docs.kics.io/latest/queries/dockercompose-queries/ce14a68b-1668-41a0-ab7d-facd9f784742

	[38;2;255;114;19m[1]:[0m docker-compose.yml:[38;2;34;187;51m19[0m

		018: 
[38;2;240;173;78m		019:   whoami0:
[0m		020:     container_name: whoiam


	[38;2;255;114;19m[2]:[0m docker-compose.yml:[38;2;34;187;51m4[0m

		003: services:
[38;2;240;173;78m		004:   caddy:
[0m		005:     container_name: caddy


[38;2;255;114;19mMemory Not Limited[0m, Severity: [38;2;255;114;19mMEDIUM[0m, Results: 2
[1mDescription:[0m Memory limits should be defined for each container. This prevents potential resource exhaustion by ensuring that containers consume not more than the designated amount of memory
[1mPlatform:[0m DockerCompose
[1mLearn more about this vulnerability:[0m https://docs.kics.io/latest/queries/dockercompose-queries/bb9ac4f7-e13b-423d-a010-c74a1bfbe492

	[38;2;255;114;19m[1]:[0m docker-compose.yml:[38;2;34;187;51m19[0m

		018: 
[38;2;240;173;78m		019:   whoami0:
[0m		020:     container_name: whoiam


	[38;2;255;114;19m[2]:[0m docker-compose.yml:[38;2;34;187;51m4[0m

		003: services:
[38;2;240;173;78m		004:   caddy:
[0m		005:     container_name: caddy


[38;2;255;114;19mHost Namespace is Shared[0m, Severity: [38;2;255;114;19mMEDIUM[0m, Results: 2
[1mDescription:[0m The hosts process namespace should not be shared by containers
[1mPlatform:[0m DockerCompose
[1mLearn more about this vulnerability:[0m https://docs.kics.io/latest/queries/dockercompose-queries/4f31dd9f-2cc3-4751-9b53-67e4af83dac0

	[38;2;255;114;19m[1]:[0m docker-compose.yml:[38;2;34;187;51m4[0m

		003: services:
[38;2;240;173;78m		004:   caddy:
[0m		005:     container_name: caddy


	[38;2;255;114;19m[2]:[0m docker-compose.yml:[38;2;34;187;51m19[0m

		018: 
[38;2;240;173;78m		019:   whoami0:
[0m		020:     container_name: whoiam


[38;2;255;114;19mHealthcheck Not Set[0m, Severity: [38;2;255;114;19mMEDIUM[0m, Results: 2
[1mDescription:[0m Check containers periodically to see if they are running properly.
[1mPlatform:[0m DockerCompose
[1mLearn more about this vulnerability:[0m https://docs.kics.io/latest/queries/dockercompose-queries/698ed579-b239-4f8f-a388-baa4bcb13ef8

	[38;2;255;114;19m[1]:[0m docker-compose.yml:[38;2;34;187;51m19[0m

		018: 
[38;2;240;173;78m		019:   whoami0:
[0m		020:     container_name: whoiam


	[38;2;255;114;19m[2]:[0m docker-compose.yml:[38;2;34;187;51m4[0m

		003: services:
[38;2;240;173;78m		004:   caddy:
[0m		005:     container_name: caddy


[38;2;255;114;19mContainer Traffic Not Bound To Host Interface[0m, Severity: [38;2;255;114;19mMEDIUM[0m, Results: 1
[1mDescription:[0m Incoming container traffic should be bound to a specific host interface
[1mPlatform:[0m DockerCompose
[1mLearn more about this vulnerability:[0m https://docs.kics.io/latest/queries/dockercompose-queries/451d79dc-0588-476a-ad03-3c7f0320abb3

	[38;2;255;114;19m[1]:[0m docker-compose.yml:[38;2;34;187;51m13[0m

		012:       - "./caddy-data:/data" #### needs volume to back up certificates
[38;2;240;173;78m		013:     ports:
[0m		014:       - "80:80"


[38;2;187;33;36mVolume Has Sensitive Host Directory[0m, Severity: [38;2;187;33;36mHIGH[0m, Results: 1
[1mDescription:[0m Container has sensitive host directory mounted as a volume
[1mPlatform:[0m DockerCompose
[1mLearn more about this vulnerability:[0m https://docs.kics.io/latest/queries/dockercompose-queries/1c1325ff-831d-43a1-973e-839ae57dfcc0

	[38;2;187;33;36m[1]:[0m docker-compose.yml:[38;2;34;187;51m11[0m

		010:     volumes:
[38;2;240;173;78m		011:       - "/var/run/docker.sock:/var/run/docker.sock" #### needs socket to read events
[0m		012:       - "./caddy-data:/data" #### needs volume to back up certificates


[38;2;187;33;36mMissing User Instruction[0m, Severity: [38;2;187;33;36mHIGH[0m, Results: 1
[1mDescription:[0m A user should be specified in the dockerfile, otherwise the image will run as root
[1mPlatform:[0m Dockerfile
[1mLearn more about this vulnerability:[0m https://docs.kics.io/latest/queries/dockerfile-queries/fd54f200-402c-4333-a5a4-36ef6709af2f

	[38;2;187;33;36m[1]:[0m Dockerfile:[38;2;34;187;51m18[0m

		017: 
[38;2;240;173;78m		018: FROM alpine:${ALPINE_VERSION}
[0m		019: 


[38;2;187;33;36mDocker Socket Mounted In Container[0m, Severity: [38;2;187;33;36mHIGH[0m, Results: 1
[1mDescription:[0m Docker socket docker.sock should not be mounted on host. If the docker socket is mounted, it can allow its processes to execute docker commands.
[1mPlatform:[0m DockerCompose
[1mLearn more about this vulnerability:[0m https://docs.kics.io/latest/queries/dockercompose-queries/d6355c88-1e8d-49e9-b2f2-f8a1ca12c75b

	[38;2;187;33;36m[1]:[0m docker-compose.yml:[38;2;34;187;51m11[0m

		010:     volumes:
[38;2;240;173;78m		011:       - "/var/run/docker.sock:/var/run/docker.sock" #### needs socket to read events
[0m		012:       - "./caddy-data:/data" #### needs volume to back up certificates



Results Summary:
[38;2;187;33;36mHIGH[0m: 3
[38;2;255;114;19mMEDIUM[0m: 22
[38;2;237;213;126mLOW[0m: 4
[38;2;91;192;222mINFO[0m: 0
TOTAL: 29

Scan duration: 4.757011986s
[38;2;255;153;19mA new version 'v1.7.13' of KICS is available, please consider updating[0m

::endgroup::
::group::[33m✅ Linted [REPOSITORY] files with [trivy]: Found 1 non blocking error(s) - (7.16s)[0m (expand for details)
- Using [trivy v0.49.1] https://megalinter.io/7.9.0/descriptors/repository_trivy
- MegaLinter key: [REPOSITORY_TRIVY]
- Rules config: identified by [trivy]
--Error detail:
2024-03-07T08:55:36.329Z	[33mWARN[0m	'--scanners config' is deprecated. Use '--scanners misconfig' instead. See https://github.com/aquasecurity/trivy/discussions/5586 for the detail.
2024-03-07T08:55:36.339Z	[34mINFO[0m	Need to update DB
2024-03-07T08:55:36.339Z	[34mINFO[0m	DB Repository: ghcr.io/aquasecurity/trivy-db
2024-03-07T08:55:36.339Z	[34mINFO[0m	Downloading DB...
32.02 MiB / 42.44 MiB [---------------------------------------------->______________] 75.46% ? p/s ?42.44 MiB / 42.44 MiB [----------------------------------------------------------->] 100.00% ? p/s ?42.44 MiB / 42.44 MiB [----------------------------------------------------------->] 100.00% ? p/s ?42.44 MiB / 42.44 MiB [---------------------------------------------->] 100.00% 17.35 MiB p/s ETA 0s42.44 MiB / 42.44 MiB [---------------------------------------------->] 100.00% 17.35 MiB p/s ETA 0s42.44 MiB / 42.44 MiB [---------------------------------------------->] 100.00% 17.35 MiB p/s ETA 0s42.44 MiB / 42.44 MiB [---------------------------------------------->] 100.00% 16.23 MiB p/s ETA 0s42.44 MiB / 42.44 MiB [---------------------------------------------->] 100.00% 16.23 MiB p/s ETA 0s42.44 MiB / 42.44 MiB [---------------------------------------------->] 100.00% 16.23 MiB p/s ETA 0s42.44 MiB / 42.44 MiB [---------------------------------------------->] 100.00% 15.18 MiB p/s ETA 0s42.44 MiB / 42.44 MiB [---------------------------------------------->] 100.00% 15.18 MiB p/s ETA 0s42.44 MiB / 42.44 MiB [---------------------------------------------->] 100.00% 15.18 MiB p/s ETA 0s42.44 MiB / 42.44 MiB [---------------------------------------------->] 100.00% 14.21 MiB p/s ETA 0s42.44 MiB / 42.44 MiB [-------------------------------------------------] 100.00% 17.01 MiB p/s 2.7s2024-03-07T08:55:39.307Z	[34mINFO[0m	Vulnerability scanning is enabled
2024-03-07T08:55:39.307Z	[34mINFO[0m	Misconfiguration scanning is enabled
2024-03-07T08:55:39.307Z	[34mINFO[0m	Need to update the built-in policies
2024-03-07T08:55:39.307Z	[34mINFO[0m	Downloading the built-in policies...
46.13 KiB / 46.13 KiB [-----------------------------------------------------------] 100.00% ? p/s 0s2024-03-07T08:55:41.985Z	[34mINFO[0m	Number of language-specific files: 0
2024-03-07T08:55:41.985Z	[34mINFO[0m	Detected config files: 1

Dockerfile (dockerfile)
=======================
Tests: 27 (SUCCESSES: 26, FAILURES: 1, EXCEPTIONS: 0)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 1, CRITICAL: 0)

HIGH: Specify at least 1 USER command in Dockerfile with non-root user as argument
════════════════════════════════════════
Running containers with 'root' user can lead to a container escape situation. It is a best practice to run containers as non-root users, which can be done by adding a 'USER' statement to the Dockerfile.

See https://avd.aquasec.com/misconfig/ds002
────────────────────────────────────────



::endgroup::
::group::[32m✅ Linted [REPOSITORY] files with [trivy-sbom] successfully - (2.75s)[0m (expand for details)
- Using [trivy-sbom v0.49.1] https://megalinter.io/7.9.0/descriptors/repository_trivy_sbom
- MegaLinter key: [REPOSITORY_TRIVY_SBOM]
- Rules config: identified by [trivy-sbom]
::endgroup::
::group::[32m✅ Linted [SPELL] files with [lychee] successfully - (0.52s)[0m (expand for details)
- Using [lychee v0.14.3] https://megalinter.io/7.9.0/descriptors/spell_lychee
- MegaLinter key: [SPELL_LYCHEE]
- Rules config: identified by [lychee]
- Number of files analyzed: [3]
::endgroup::
::group::[32m✅ Linted [DOCKERFILE] files with [hadolint] successfully - (0.08s)[0m (expand for details)
- Using [hadolint v2.12.0] https://megalinter.io/7.9.0/descriptors/dockerfile_hadolint
- MegaLinter key: [DOCKERFILE_HADOLINT]
- Rules config: [.hadolint.yaml]
- Number of files analyzed: [1]
::endgroup::
::group::[32m✅ Linted [REPOSITORY] files with [dustilock] successfully - (0.04s)[0m (expand for details)
- Using [dustilock v1.2.0] https://megalinter.io/7.9.0/descriptors/repository_dustilock
- MegaLinter key: [REPOSITORY_DUSTILOCK]
- Rules config: identified by [dustilock]
::endgroup::
::group::[32m✅ Linted [REPOSITORY] files with [gitleaks] successfully - (0.24s)[0m (expand for details)
- Using [gitleaks v8.18.2] https://megalinter.io/7.9.0/descriptors/repository_gitleaks
- MegaLinter key: [REPOSITORY_GITLEAKS]
- Rules config: [.gitleaks.toml]
::endgroup::
::group::[32m✅ Linted [REPOSITORY] files with [grype] successfully - (13.4s)[0m (expand for details)
- Using [grype v0.74.5] https://megalinter.io/7.9.0/descriptors/repository_grype
- MegaLinter key: [REPOSITORY_GRYPE]
- Rules config: [.grype.yaml]
::endgroup::
::group::[32m✅ Linted [REPOSITORY] files with [syft] successfully - (0.31s)[0m (expand for details)
- Using [syft v0.104.0] https://megalinter.io/7.9.0/descriptors/repository_syft
- MegaLinter key: [REPOSITORY_SYFT]
- Rules config: identified by [syft]
::endgroup::
::group::[32m✅ Linted [REPOSITORY] files with [git_diff] successfully - (0.03s)[0m (expand for details)
- Using [git_diff v2.43.0] https://megalinter.io/7.9.0/descriptors/repository_git_diff
- MegaLinter key: [REPOSITORY_GIT_DIFF]
- Rules config: identified by [git_diff]
::endgroup::
::group::[32m✅ Linted [YAML] files with [yamllint] successfully - (0.33s)[0m (expand for details)
- Using [yamllint v1.34.0] https://megalinter.io/7.9.0/descriptors/yaml_yamllint
- MegaLinter key: [YAML_YAMLLINT]
- Rules config: [.yamllint.yml]
- Number of files analyzed: [1]
::endgroup::
::group::[33m✅ Linted [REPOSITORY] files with [checkov]: Found 3 non blocking error(s) - (12.69s)[0m (expand for details)
- Using [checkov v3.2.20] https://megalinter.io/7.9.0/descriptors/repository_checkov
- MegaLinter key: [REPOSITORY_CHECKOV]
- Rules config: [.checkov.yml]
--Error detail:
dockerfile scan results:

Passed checks: 97, Failed checks: 1, Skipped checks: 0

Check: CKV_DOCKER_3: "Ensure that a user for the container has been created"
	FAILED for resource: /Dockerfile.
	File: /Dockerfile:1-40
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-that-a-user-for-the-container-has-been-created

		1  | ARG GOLANG_VERSION=1.22.1
		2  | ARG ALPINE_VERSION=3.19
		3  | 
		4  | FROM golang:${GOLANG_VERSION}-alpine${ALPINE_VERSION} as gobuild
		5  | ARG GOLANG_VERSION
		6  | ARG ALPINE_VERSION
		7  | 
		8  | WORKDIR /go/src/github.com/caddyserver/xcaddy/cmd/xcaddy
		9  | 
		10 | RUN apk add --no-cache git gcc build-base; \
		11 | 	go install github.com/caddyserver/xcaddy/cmd/xcaddy@latest
		12 | 
		13 | RUN  xcaddy build \
		14 | 	 --output /go/src/github.com/caddyserver/xcaddy/cmd/caddy \
		15 | 	 --with github.com/lucaslorentz/caddy-docker-proxy/v2 \
		16 | 	 --with github.com/caddy-dns/cloudflare
		17 | 
		18 | FROM alpine:${ALPINE_VERSION}
		19 | 
		20 | ARG GOLANG_VERSION
		21 | ARG ALPINE_VERSION
		22 | 
		23 | RUN apk add --no-cache ca-certificates curl tzdata; \
		24 |              rm -rf /var/cache/apk/*;
		25 | 
		26 | LABEL maintainer "HomeAll"
		27 | 
		28 | EXPOSE 80 443 2019
		29 | 
		30 | ENV XDG_CONFIG_HOME /config
		31 | 
		32 | ENV XDG_DATA_HOME /data
		33 | 
		34 | COPY --from=gobuild /go/src/github.com/caddyserver/xcaddy/cmd/caddy /bin/
		35 | 
		36 | HEALTHCHECK --interval=10s --timeout=5s --start-period=5s CMD curl -fsS http://127.0.0.1:2019/config -o /dev/null || exit 1
		37 | 
		38 | ENTRYPOINT ["/bin/caddy"]
		39 | 
		40 | CMD ["docker-proxy"]

github_actions scan results:

Passed checks: 70, Failed checks: 2, Skipped checks: 0

Check: CKV2_GHA_1: "Ensure top-level permissions are not set to write-all"
	FAILED for resource: on(CI)
	File: /.github/workflows/main.yml:0-1
Check: CKV2_GHA_1: "Ensure top-level permissions are not set to write-all"
	FAILED for resource: on(MegaLinter)
	File: /.github/workflows/mega-linter.yml:26-27


::endgroup::
::group::[32m✅ Linted [REPOSITORY] files with [trufflehog] successfully - (6.31s)[0m (expand for details)
- Using [trufflehog v3.68.5] https://megalinter.io/7.9.0/descriptors/repository_trufflehog
- MegaLinter key: [REPOSITORY_TRUFFLEHOG]
- Rules config: identified by [trufflehog]
::endgroup::

+----SUMMARY----+--------------------------+---------------+-------+-------+--------+--------------+
| Descriptor    | Linter                   | Mode          | Files | Fixed | Errors | Elapsed time |
+---------------+--------------------------+---------------+-------+-------+--------+--------------+
| ✅ COPYPASTE  | jscpd                    | project       |   n/a |       |      0 |        0.83s |
| ✅ DOCKERFILE | hadolint                 | list_of_files |     1 |       |      0 |        0.08s |
| ⚠️ MARKDOWN   | markdownlint             | list_of_files |     2 |     1 |      1 |        0.67s |
| ✅ MARKDOWN   | markdown-link-check      | list_of_files |     2 |       |      0 |        1.29s |
| ✅ MARKDOWN   | markdown-table-formatter | list_of_files |     2 |     1 |      0 |        0.27s |
| ⚠️ REPOSITORY | checkov                  | project       |   n/a |       |      3 |       12.69s |
| ✅ REPOSITORY | devskim                  | project       |   n/a |       |      0 |        1.48s |
| ✅ REPOSITORY | dustilock                | project       |   n/a |       |      0 |        0.04s |
| ✅ REPOSITORY | gitleaks                 | project       |   n/a |       |      0 |        0.24s |
| ✅ REPOSITORY | git_diff                 | project       |   n/a |       |      0 |        0.03s |
| ✅ REPOSITORY | grype                    | project       |   n/a |       |      0 |        13.4s |
| ⚠️ REPOSITORY | kics                     | project       |   n/a |       |      1 |        5.53s |
| ✅ REPOSITORY | secretlint               | project       |   n/a |       |      0 |        1.05s |
| ✅ REPOSITORY | syft                     | project       |   n/a |       |      0 |        0.31s |
| ⚠️ REPOSITORY | trivy                    | project       |   n/a |       |      1 |        7.16s |
| ✅ REPOSITORY | trivy-sbom               | project       |   n/a |       |      0 |        2.75s |
| ✅ REPOSITORY | trufflehog               | project       |   n/a |       |      0 |        6.31s |
| ⚠️ SPELL      | cspell                   | list_of_files |     5 |       |     17 |        3.19s |
| ✅ SPELL      | lychee                   | list_of_files |     3 |       |      0 |        0.52s |
| ✅ YAML       | prettier                 | list_of_files |     1 |     1 |      0 |        0.47s |
| ✅ YAML       | v8r                      | list_of_files |     1 |       |      0 |        2.34s |
| ✅ YAML       | yamllint                 | list_of_files |     1 |       |      0 |        0.33s |
+---------------+--------------------------+---------------+-------+-------+--------+--------------+

[Updated Sources Reporter] copied 2 fixed source files in folder /github/workspace/megalinter-reports/updated_sources.
Download it from artifacts then copy-paste it in your local repo to apply linters updates
[GitHub Comment Reporter] Posted summary as comment on homeall/caddy-reverse-proxy-cloudflare #PR24
[33m⚠️ Successfully linted all files, but with ignored errors[0m
